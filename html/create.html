<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>Filebed</title>
    <link rel="stylesheet" href="https://www.layuicdn.com/layui/css/layui.css" media="all">
    <link rel="stylesheet" type="text/css" href="/static/layui-theme.css" />
    <link rel="stylesheet" type="text/css" href="/static/style.css" />
    <style>
        #container {
            box-shadow: 0 2px 3px 0 rgba(7, 17, 27, 0.1);
            transition: .3s all linear;
            padding: 20px;
        }
    </style>
</head>

<body>
    <ul class="layui-nav" lay-filter="">
        <li class="layui-nav-item layui-this"><a href="/">添加</a></li>
        <li class="layui-nav-item"><a href="/cards/">收藏列表</a></li>
        <li class="layui-nav-item"><a href="https://github.com/istommao/collectors" target="_blank">GitHub</a></li>
    </ul>
    <div id="wrapper">
        <div id="container">
            <div style="margin-top:30px;"></div>
            <form class="layui-form" action="" id="createForm">
                <div class="layui-form-item">
                    <label class="layui-form-label">内容</label>
                    <div class="layui-input-block">
                        <input type="text" id="formContent" name="content" autofocus="true" lay-verify="title" autocomplete="off" placeholder="请输入内容" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">类型</label>
                    <div class="layui-input-block">
                        <input type="radio" name="type" value="website" title="站点" checked="">
                        <input type="radio" name="type" value="app" title="App">
                        <input type="radio" name="type" value="goods" title="商品">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">标签</label>
                    <div class="layui-input-block">
                        <input type="checkbox" name="tag[article]" title="文章">
                        <input type="checkbox" name="tag[blog]" title="Blog">
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button type="submit" class="layui-btn" lay-submit="" lay-filter="createForm">创建</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script type="text/javascript" src="/static/jquery.js"></script>
    <script src="https://www.layuicdn.com/layui/layui.js" charset="utf-8"></script>
    <script>
    layui.use(['form', 'layedit', 'laydate'], function() {
        var form = layui.form,
            layer = layui.layer,
            layedit = layui.layedit,
            laydate = layui.laydate;

        //监听提交
        form.on('submit(createForm)', function(data) {
            var formData = data.field;
            if (formData.content == '') {
                layer.msg('请输入内容');
                $('#formContent').focus();
                return false;
            }

            doCreate(formData)

            return false;
        });

        function doCreate() {
            var baseURL = document.location.origin;
            var form = $('#createForm');

            $.ajax({
                url: baseURL + '/api/items/',
                type: 'post',
                data: form.serialize(),
                async: false,
                success: function(resp) {
                    if (resp.Status == 0) {
                        layer.alert(resp.message, { icon: 5 })
                    } else {
                        layer.alert(resp.message, { icon: 1 })

                    }

                    setTimeout(function() {
                        window.location.href = baseURL + '/';
                    }, 1500);

                }
            })
        }
    });
    </script>
</body>

</html>